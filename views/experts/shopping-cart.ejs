
<div class="container py-5">
    <h2 class="mb-4">Votre Panier</h2>

    <% if (Object.keys(shoppingCart).length > 0) { %>
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>Image</th>
                    <th>Produit</th>
                    <th>Prix unitaire</th>
                    <th>Quantit√©</th>
                    <th>Total</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <% let total = 0; %>
                <% for (let id in shoppingCart) { 
                    let item = shoppingCart[id];
                    let price = parseFloat(item.price) || 0;
                    let quantity = parseInt(item.quantity) || 0;
                    let totalItem = price * quantity;
                    total += totalItem;
                %>
                <tr>
                    <td width="100">
                        <img src="/images/produits/<%= item.image || 'default.jpg' %>" class="img-fluid" width="80" alt="<%= item.name || 'Produit' %>">
                    </td>
                    <td><%= item.name || 'Sans nom' %></td>
                    <td><%= price.toFixed(0) %>$</td>
                    <td><%= quantity %></td>
                    <td><%= totalItem.toFixed(0) %>$</td>
                    <td>
                        <form action="/experts/shopping-cart/delete/<%= id %>" method="POST" onsubmit="return confirm('Supprimer ce produit ?');">
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                            <button class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></button>
                        </form>
                    </td>
                </tr>
                <% } %>
                <tr class="table-info">
                    <td colspan="4" class="text-end fw-bold">Total</td>
                    <td colspan="2" class="fw-bold"><%= total.toFixed(0) %>$</td>
                </tr>

            </tbody>
        </table>

        <form action="experts/shopping-cart/reset" method="POST" class="mt-3">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button class="btn btn-outline-danger" onclick="return confirm('Vider le panier ?')">Vider le panier</button>
            <a href="/experts/catalogue" class="btn btn-outline-primary">Revenir au catalogue</a>
        </form>
            
    <% } else { %>
        <div class="alert alert-info">
            Votre panier est vide.
        </div>
    <% } %>
</div>
